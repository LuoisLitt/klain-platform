<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voorraad — Dura Fulfilment</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .loading-spinner {
            width: 24px; height: 24px;
            border: 3px solid #e5e7eb;
            border-top-color: #2563eb;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            display: inline-block;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <script src="auth.js"></script>
    <!-- Navigation -->
    <nav>
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html" class="logo">Dura <span>Fulfilment</span></a>
                <ul class="nav-links">
                    <li><a href="index.html">Dashboard</a></li>
                    <li><a href="orders.html">Orders</a></li>
                    <li><a href="voorraad.html" class="active">Voorraad</a></li>
                    <li><a href="verzendingen.html">Verzendingen</a></li>
                    <li><a href="rapportages.html">Rapportages</a></li>
                </ul>
            </div>
            <div class="nav-right">
                <div class="global-search" style="position:relative;">
                    <input type="text" id="globalSearch" placeholder="Zoek order, klant, SKU..."
                        style="width:220px;padding:8px 12px 8px 34px;border:1px solid #d2d2d7;border-radius:8px;font-size:13px;font-family:inherit;background:var(--gray-light);outline:none;transition:all 0.2s;"
                        onfocus="this.style.width='300px';this.style.borderColor='var(--blue)';this.style.background='#fff'"
                        onblur="this.style.width='220px';this.style.borderColor='#d2d2d7';this.style.background='var(--gray-light)'"
                        onkeydown="if(event.key==='Enter'){var q=this.value.trim();if(q)window.location.href='orders.html?search='+encodeURIComponent(q);}">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:#8e93a6;pointer-events:none;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                    </svg>
                </div>
                <a href="warehouse.html" class="btn-warehouse" title="Warehouse Display">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125z" />
                    </svg>
                    Warehouse Display
                </a>
                <div class="nav-user">
                    <div class="user-avatar" id="userAvatar">DF</div>
                    <span class="user-name" id="userName">Demo Account</span>
                </div>
                <button class="hamburger" aria-label="Menu" aria-expanded="false">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <!-- Header -->
        <header class="page-header">
            <div class="header-title">
                <h1>Voorraad</h1>
                <p>Realtime voorraadniveaus uit Goedgepickt</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="openAlertSettings()">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                    </svg>
                    Alert Instellingen
                </button>
                <button class="btn btn-primary">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                    </svg>
                    Sync Goedgepickt
                </button>
            </div>
        </header>

        <!-- Stats Row -->
        <div class="stats-row">
            <div class="stat-box">
                <span class="stat-value" id="statTotalProducts">—</span>
                <span class="stat-label">Totaal producten</span>
            </div>
            <div class="stat-box">
                <span class="stat-value red" id="statCritical">—</span>
                <span class="stat-label">Kritiek laag (≤5)</span>
            </div>
            <div class="stat-box">
                <span class="stat-value orange" id="statWarning">—</span>
                <span class="stat-label">Laag (≤25)</span>
            </div>
        </div>

        <!-- Alerts Section -->
        <div class="card" id="alertsCard" style="border-left: 4px solid var(--red); margin-bottom: 24px;">
            <div class="card-header">
                <div>
                    <div class="card-title">Voorraad Alerts</div>
                    <div class="card-subtitle">Producten met lage voorraad (live uit Goedgepickt)</div>
                </div>
            </div>
            <table class="data-table" id="alertsTable">
                <thead>
                    <tr>
                        <th>SKU</th>
                        <th>Product</th>
                        <th>Voorraad</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="alertsBody">
                    <tr><td colspan="4" style="text-align:center;padding:40px;color:#999;">Bezig met laden...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Filters -->
        <div class="filters-bar">
            <div class="search-box">
                <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <input type="text" placeholder="Zoek op SKU of productnaam..." id="searchInput" onkeyup="filterProducts()">
            </div>
            <div class="filter-group">
                <select id="categoryFilter" onchange="filterProducts()">
                    <option value="">Alle categorieën</option>
                    <option value="hoodies">Hoodies</option>
                    <option value="tshirts">T-Shirts</option>
                    <option value="jeans">Jeans</option>
                    <option value="sweaters">Sweaters</option>
                    <option value="accessoires">Accessoires</option>
                </select>
                <select id="stockFilter" onchange="filterProducts()">
                    <option value="">Alle voorraad</option>
                    <option value="critical">Kritiek laag</option>
                    <option value="low">Onder bestelpunt</option>
                    <option value="ok">Op peil</option>
                    <option value="high">Hoog</option>
                </select>
            </div>
        </div>

        <!-- Products Table -->
        <div class="card">
            <div class="card-header">
                <div>
                    <div class="card-title">Alle Producten</div>
                    <div class="card-subtitle" id="productsSubtitle">Laden...</div>
                </div>
                <button class="btn btn-secondary" onclick="exportInventory()">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
                    </svg>
                    Exporteer
                </button>
            </div>
            <table class="data-table" id="productsTable">
                <thead>
                    <tr>
                        <th>SKU</th>
                        <th>Product</th>
                        <th>Voorraad</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="productsBody">
                    <tr><td colspan="4" style="text-align:center;padding:40px;color:#999;">Bezig met laden...</td></tr>
                </tbody>
            </table>
            <div id="inventoryPagination" style="display:flex;align-items:center;justify-content:center;gap:12px;padding:20px 0;"></div>
        </div>
    </main>

    <!-- Alert Settings Modal -->
    <div class="modal-overlay" id="alertSettingsModal" onclick="closeAlertSettings(event)">
        <div class="modal" onclick="event.stopPropagation()" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Voorraad Alert Instellingen</h2>
                <button class="btn-close" onclick="closeAlertSettings()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--gray-dark); margin-bottom: 24px;">
                    Stel per product of categorie in wanneer u een melding ontvangt over lage voorraad. 
                    Alerts worden verzonden via e-mail en in het dashboard getoond.
                </p>

                <h3 style="font-size: 14px; font-weight: 600; color: var(--gray-medium); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 16px;">Globale Instellingen</h3>
                
                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">E-mail notificaties</span>
                        <span class="alert-setting-desc">Ontvang dagelijks een overzicht van lage voorraad</span>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">Push notificaties</span>
                        <span class="alert-setting-desc">Direct melding bij kritieke voorraad (&lt;10 stuks)</span>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <h3 style="font-size: 14px; font-weight: 600; color: var(--gray-medium); text-transform: uppercase; letter-spacing: 0.5px; margin: 32px 0 16px;">Standaard Minimumniveaus per Categorie</h3>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">Hoodies</span>
                        <span class="alert-setting-desc">Alert wanneer voorraad onder dit niveau komt</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="25" min="0">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">T-Shirts</span>
                        <span class="alert-setting-desc">Alert wanneer voorraad onder dit niveau komt</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="30" min="0">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">Jeans</span>
                        <span class="alert-setting-desc">Alert wanneer voorraad onder dit niveau komt</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="20" min="0">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">Sweaters</span>
                        <span class="alert-setting-desc">Alert wanneer voorraad onder dit niveau komt</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="25" min="0">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <div class="alert-setting">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title">Accessoires</span>
                        <span class="alert-setting-desc">Alert wanneer voorraad onder dit niveau komt</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="15" min="0">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <h3 style="font-size: 14px; font-weight: 600; color: var(--gray-medium); text-transform: uppercase; letter-spacing: 0.5px; margin: 32px 0 16px;">Kritiek Niveau</h3>

                <div class="alert-setting" style="background: var(--red-light);">
                    <div class="alert-setting-info">
                        <span class="alert-setting-title" style="color: var(--red);">Kritiek niveau</span>
                        <span class="alert-setting-desc">Onder dit aantal is de voorraad kritiek laag</span>
                    </div>
                    <div class="alert-setting-input">
                        <input type="number" value="10" min="0" style="border-color: var(--red);">
                        <span style="color: var(--gray-medium);">stuks</span>
                    </div>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 32px;">
                    <button class="btn btn-secondary" onclick="closeAlertSettings()" style="flex: 1;">Annuleren</button>
                    <button class="btn btn-primary" onclick="saveAlertSettings()" style="flex: 1;">Opslaan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div class="modal-overlay" id="editProductModal" onclick="closeEditProduct(event)">
        <div class="modal" onclick="event.stopPropagation()" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Product Bewerken</h2>
                <button class="btn-close" onclick="closeEditProduct()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">SKU</label>
                    <input type="text" class="form-input" id="editSku" value="BLK-HOOD-M" readonly style="background: var(--gray-light);">
                </div>
                <div class="form-group">
                    <label class="form-label">Productnaam</label>
                    <input type="text" class="form-input" id="editName" value="Zwarte Hoodie - Maat M">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Minimum voorraad</label>
                        <input type="number" class="form-input" id="editMinStock" value="25">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Locatie</label>
                        <input type="text" class="form-input" id="editLocation" value="A-12-3">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Categorie</label>
                    <select class="form-input" id="editCategory">
                        <option value="hoodies" selected>Hoodies</option>
                        <option value="tshirts">T-Shirts</option>
                        <option value="jeans">Jeans</option>
                        <option value="sweaters">Sweaters</option>
                        <option value="accessoires">Accessoires</option>
                    </select>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button class="btn btn-secondary" onclick="closeEditProduct()" style="flex: 1;">Annuleren</button>
                    <button class="btn btn-primary" onclick="saveProduct()" style="flex: 1;">Opslaan</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // LIVE API INTEGRATION — Alles uit Goedgepickt
        // ============================================
        const API_BASE = window.DURA_API_BASE;
        const API_HEADERS = window.DURA_API_HEADERS;
        let currentInvPage = 1;
        let totalInvPages = 1;
        let totalInvProducts = 0;

        function getStockNumber(product) {
            // Stock kan een object zijn (Goedgepickt API) of een nummer
            const stock = product.stock;
            if (stock && typeof stock === 'object') {
                return stock.freeStock || stock.totalStock || 0;
            }
            return stock || product.stockLevel || 0;
        }

        function showTableMessage(tbody, colspan, text, color) {
            tbody.textContent = '';
            const tr = document.createElement('tr');
            const td = document.createElement('td');
            td.colSpan = colspan;
            td.style.cssText = 'text-align:center;padding:40px;color:' + (color || '#999') + ';';
            td.textContent = text;
            tr.appendChild(td);
            tbody.appendChild(tr);
        }

        function createProductRow(sku, name, stock, statusClass, statusLabel, stockClass) {
            const tr = document.createElement('tr');
            const tdSku = document.createElement('td');
            const code = document.createElement('code');
            code.textContent = sku;
            tdSku.appendChild(code);

            const tdName = document.createElement('td');
            tdName.textContent = name;

            const tdStock = document.createElement('td');
            const strong = document.createElement('strong');
            if (stockClass) strong.className = stockClass;
            strong.textContent = stock.toLocaleString('nl-NL');
            tdStock.appendChild(strong);

            const tdStatus = document.createElement('td');
            const badge = document.createElement('span');
            badge.className = 'status-badge ' + statusClass;
            const dot = document.createElement('span');
            dot.className = 'status-dot';
            badge.appendChild(dot);
            badge.appendChild(document.createTextNode(statusLabel));
            tdStatus.appendChild(badge);

            tr.appendChild(tdSku);
            tr.appendChild(tdName);
            tr.appendChild(tdStock);
            tr.appendChild(tdStatus);
            return tr;
        }

        async function loadInventory(page) {
            currentInvPage = page || 1;
            const tbody = document.getElementById('productsBody');
            showTableMessage(tbody, 4, 'Bezig met laden...');

            try {
                const res = await fetch(API_BASE + '/api/inventory?page=' + currentInvPage, { headers: API_HEADERS });
                if (!res.ok) throw new Error('Inventory API error: ' + res.status);
                const json = await res.json();
                const allProducts = json.data || [];
                totalInvPages = json.lastPage || 1;
                const totalFromApi = json.total || json.count || allProducts.length;

                // Filter: toon ALLEEN producten met voorraad > 0
                const products = allProducts.filter(p => getStockNumber(p) > 0);

                // Update stats
                const inStockCount = products.length;
                document.getElementById('statTotalProducts').textContent = totalFromApi.toLocaleString('nl-NL');
                document.getElementById('productsSubtitle').textContent = inStockCount + ' van ' + allProducts.length + ' producten op deze pagina hebben voorraad';

                tbody.textContent = '';
                if (!products.length) {
                    showTableMessage(tbody, 4, 'Geen producten met voorraad op deze pagina');
                    updateInvPagination();
                    return;
                }

                // Sorteer op voorraad (laagste eerst)
                products.sort((a, b) => getStockNumber(a) - getStockNumber(b));

                products.forEach(product => {
                    const sku = product.sku || product.productSku || '\u2014';
                    const name = product.name || product.productName || '\u2014';
                    const stock = getStockNumber(product);

                    let statusClass = 'ok', statusLabel = 'Op peil', stockClass = 'green';
                    if (stock <= 5) { statusClass = 'critical'; statusLabel = 'Kritiek'; stockClass = 'red'; }
                    else if (stock <= 25) { statusClass = 'warning'; statusLabel = 'Laag'; stockClass = 'orange'; }
                    else if (stock <= 100) { stockClass = ''; }

                    tbody.appendChild(createProductRow(sku, name, stock, statusClass, statusLabel, stockClass));
                });

                updateInvPagination();
            } catch (e) {
                console.log('Inventory API niet beschikbaar:', e.message);
                showTableMessage(tbody, 4, 'Fout bij laden: ' + e.message, '#c00');
            }
        }

        function createInvPagBtn(text, page, disabled) {
            const btn = document.createElement('button');
            btn.textContent = text;
            btn.disabled = disabled;
            btn.style.cssText = 'padding:6px 12px;border:1px solid #e5e7eb;border-radius:6px;background:' + (disabled ? '#f3f4f6' : '#fff') + ';cursor:' + (disabled ? 'default' : 'pointer');
            if (!disabled) btn.addEventListener('click', function() { loadInventory(page); });
            return btn;
        }

        function updateInvPagination() {
            const pagDiv = document.getElementById('inventoryPagination');
            pagDiv.textContent = '';

            if (totalInvPages <= 1) {
                const span = document.createElement('span');
                span.style.cssText = 'color:#8e93a6;font-size:14px;';
                span.textContent = 'Pagina 1 van 1 (' + totalInvProducts + ' producten)';
                pagDiv.appendChild(span);
                return;
            }

            pagDiv.appendChild(createInvPagBtn('\u2039 Vorige', currentInvPage - 1, currentInvPage <= 1));

            const info = document.createElement('span');
            info.style.cssText = 'font-size:14px;color:#6b7084;';
            info.appendChild(document.createTextNode('Pagina '));
            const b1 = document.createElement('strong');
            b1.textContent = currentInvPage;
            info.appendChild(b1);
            info.appendChild(document.createTextNode(' van '));
            const b2 = document.createElement('strong');
            b2.textContent = totalInvPages;
            info.appendChild(b2);
            info.appendChild(document.createTextNode(' (' + totalInvProducts.toLocaleString('nl-NL') + ' producten)'));
            pagDiv.appendChild(info);

            pagDiv.appendChild(createInvPagBtn('Volgende \u203A', currentInvPage + 1, currentInvPage >= totalInvPages));
        }

        async function loadAlerts() {
            const tbody = document.getElementById('alertsBody');
            try {
                const res = await fetch(API_BASE + '/api/inventory/alerts', { headers: API_HEADERS });
                if (!res.ok) throw new Error('Alerts API error');
                const json = await res.json();
                const alerts = json.data || [];

                // Update stats
                let criticalCount = 0, lowCount = 0;
                alerts.forEach(a => {
                    const stock = getStockNumber(a);
                    if (stock <= 5) criticalCount++;
                    else lowCount++;
                });
                document.getElementById('statCritical').textContent = criticalCount;
                document.getElementById('statWarning').textContent = lowCount;

                if (!alerts.length) {
                    tbody.textContent = '';
                    const tr = document.createElement('tr');
                    const td = document.createElement('td');
                    td.colSpan = 4;
                    td.style.cssText = 'text-align:center;padding:40px;color:#16a34a;font-weight:500;';
                    td.textContent = '\u2713 Geen voorraad alerts';
                    tr.appendChild(td);
                    tbody.appendChild(tr);
                    return;
                }

                tbody.textContent = '';
                alerts.slice(0, 20).forEach(alert => {
                    const sku = alert.sku || alert.productSku || '\u2014';
                    const name = alert.name || alert.productName || '\u2014';
                    const stock = getStockNumber(alert);
                    const isCritical = stock <= 5;

                    tbody.appendChild(createProductRow(
                        sku, name, stock,
                        isCritical ? 'critical' : 'warning',
                        isCritical ? 'Kritiek' : 'Laag',
                        isCritical ? 'red' : 'orange'
                    ));
                });
            } catch (e) {
                console.log('Alerts API niet beschikbaar:', e.message);
                showTableMessage(tbody, 4, 'Alerts niet beschikbaar');
            }
        }

        // Load live data
        loadInventory(1);
        loadAlerts();

        // ============================================
        // EXISTING FUNCTIONS
        // ============================================
        function filterProducts() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const stock = document.getElementById('stockFilter').value;
            const rows = document.querySelectorAll('#productsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const rowCategory = row.dataset.category;
                const rowStock = row.dataset.stock;
                
                const matchSearch = text.includes(search);
                const matchCategory = !category || rowCategory === category;
                const matchStock = !stock || rowStock === stock;
                
                row.style.display = matchSearch && matchCategory && matchStock ? '' : 'none';
            });
        }

        function openAlertSettings() {
            document.getElementById('alertSettingsModal').classList.add('active');
        }

        function closeAlertSettings(event) {
            if (!event || event.target.classList.contains('modal-overlay')) {
                document.getElementById('alertSettingsModal').classList.remove('active');
            }
        }

        function saveAlertSettings() {
            alert('Instellingen opgeslagen! In productie worden deze instellingen bewaard en toegepast op alle voorraadcontroles.');
            closeAlertSettings();
        }

        function editProduct(sku) {
            document.getElementById('editSku').value = sku;
            document.getElementById('editProductModal').classList.add('active');
        }

        function closeEditProduct(event) {
            if (!event || event.target.classList.contains('modal-overlay')) {
                document.getElementById('editProductModal').classList.remove('active');
            }
        }

        function saveProduct() {
            alert('Product bijgewerkt! In productie wordt dit gesynchroniseerd met Goedgepickt.');
            closeEditProduct();
        }

        function exportInventory() {
            alert('Export functie: In productie zou dit een CSV/Excel export genereren vanuit Goedgepickt.');
        }

        // Close modals on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAlertSettings();
                closeEditProduct();
            }
        });
    </script>
<script src="nav.js"></script>
<script src="ai-insights.js"></script>
</body>
</html>
